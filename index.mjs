// Copyright (c) 2023 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@esm/index.mjs";import{isPrimitive as s}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-array@esm/index.mjs";import{isPrimitive as n}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-nonnegative-integer@esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-ndarray-like@esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-shape2strides@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-strides2offset@esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-strides2order@esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-numel@esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-ctor@esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-data-type@esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-order@esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-casting-mode@esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-allowed-data-type-cast@esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-buffer@esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-buffer-dtype@esm/index.mjs";import y from"https://cdn.jsdelivr.net/gh/stdlib-js/array-shape@esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-flatten-array@esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@v0.0.2-esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/constants-float64-pinf@v0.0.8-esm/index.mjs";import w from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-assert-is-integer@esm/index.mjs";import x from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-defaults@esm/index.mjs";import L from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-buffer-ctors@esm/index.mjs";import E from"https://cdn.jsdelivr.net/gh/stdlib-js/buffer-alloc-unsafe@esm/index.mjs";import T from"https://cdn.jsdelivr.net/gh/stdlib-js/math-base-special-abs@esm/index.mjs";function R(e){return"object"==typeof e&&null!==e&&"number"==typeof e.length&&w(e.length)&&e.length>=0&&e.length<v}function P(e,r,s){var t,n,i;if(t=L(s),"generic"===s)for(n=[],i=0;i<r;i++)n.push(e[i]);else if("binary"===s)for(n=E(r),i=0;i<r;i++)n[i]=e[i];else for(n=new t(r),i=0;i<r;i++)n[i]=e[i];return n}function Y(e,r){return"generic"===r?function(e){var r,s,t;for(r=e.length,s=[],t=0;t<r;t++)s.push(e.get(t));return s}(e):"binary"===r?function(e){var r,s,t;for(r=e.length,s=E(r),t=0;t<r;t++)s[t]=e.get(t);return s}(e):function(e,r){var s,t,n;for(t=new(L(r))(s=e.length),n=0;n<s;n++)t[n]=e.get(n);return t}(e,r)}function k(e,r,s){var t,n;for(t=[],n=0;n<s-e;n++)t.push(1);for(n=0;n<e;n++)t.push(r[n]);return t}function K(e,r,s,t){var n,i,d,o,m;if(m=e-(i=s.length),n=[],"row-major"===t){for(d=T(s[0])*r[m],o=0;o<m;o++)n.push(d);for(o=0;o<i;o++)n.push(s[o])}else{for(o=0;o<m;o++)n.push(1);for(o=0;o<i;o++)n.push(s[o])}return n}var M={casting:x.get("casting"),copy:!1,dtype:x.get("dtypes.default"),flatten:!0,mode:x.get("index_mode"),ndmin:0,order:x.get("order"),readonly:!1};function N(){var v,w,x,L,E,T,N,O,Q,X,_,q,z;if(1===arguments.length)if(R(arguments[0]))x=arguments[0],v={};else{if(!r(v=arguments[0]))throw new TypeError(u("0Le5K",v));if(e(v,"buffer")&&!R(x=v.buffer))throw new TypeError(u("0Le5L","buffer",x))}else{if(!R(x=arguments[0]))throw new TypeError(u("0Le5M",x));if(!r(v=arguments[1]))throw new TypeError(u("0Le2h",v))}if(x&&(i(x)?(N=x.dtype,z=!0):(N=c(x),z=!1)),X={},_={},e(v,"casting")){if(_.casting=v.casting,!h(_.casting))throw new TypeError(u("0Le5N","casting",_.casting))}else _.casting=M.casting;if(e(v,"flatten")){if(_.flatten=v.flatten,!s(_.flatten))throw new TypeError(u("0Le30","flatten",_.flatten))}else _.flatten=M.flatten;if(e(v,"ndmin")){if(_.ndmin=v.ndmin,!n(_.ndmin))throw new TypeError(u("0Le35","ndmin",_.ndmin))}else _.ndmin=M.ndmin;if(e(v,"dtype")){if(T=v.dtype,!f(T))throw new TypeError(u("0Le5O","dtype",T));if(N&&!j(N,T,_.casting))throw new Error(u("0Le5P",_.casting,N,T))}else T=N&&(z||"generic"!==N)?N:M.dtype;if(e(v,"order")){if("any"===(E=v.order)||"same"===E)z?"any"===E?E=3===m(x.strides)?M.order:x.order:"same"===E&&(E=x.order):E=M.order;else if(!p(E))throw new TypeError(u("0Le5Q","order",E))}else E=M.order;if(e(v,"mode")?X.mode=v.mode:X.mode=M.mode,e(v,"submode")?X.submode=v.submode:X.submode=[X.mode],e(v,"readonly")?X.readonly=v.readonly:X.readonly=M.readonly,e(v,"copy")){if(_.copy=v.copy,!s(_.copy))throw new TypeError(u("0Le30","copy",_.copy))}else _.copy=M.copy;if(e(v,"shape")){if(!R(O=v.shape))throw new TypeError(u("0Le5R","shape",O));Q=O.length,q=a(O)}else{if(!x)throw new Error(u("0Le0X"));z?(O=x.shape,Q=x.ndims,q=x.length):_.flatten&&t(x)?(Q=(O=y(x)).length,q=a(O)):(Q=1,O=[q=x.length])}if(Q<_.ndmin&&(O=k(Q,O,_.ndmin),Q=_.ndmin),z){if(x.length!==q)throw new RangeError(u("0Le0Y"));N!==T||_.copy?x=Y(x,T):(w=x.strides,L=x.offset,x=x.data,w.length<Q&&(w=K(Q,O,w,E)))}else if(x){if("generic"===N&&_.flatten&&(x=b(x)),x.length!==q)throw new RangeError(u("0Le0Y"));(N!==T||_.copy)&&(x=P(x,q,T))}else x=g(T,q);return void 0===w&&(w=d(O,E),L=o(O,w)),new l(T,x,O,w,L,E,X)}export{N as default};
//# sourceMappingURL=index.mjs.map
